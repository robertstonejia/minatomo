<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高度人材ポイント計算 | みんなの日中交流会</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            line-height: 1.6;
            color: #000;
            background: linear-gradient(135deg, #fef8f0 0%, #fff9f3 50%, #fdf5eb 100%);
            min-height: 100vh;
            padding: 20px;
            -webkit-font-smoothing: antialiased;
            font-weight: 500;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08), 0 4px 16px rgba(0,0,0,0.04);
            overflow: hidden;
        }

        /* Top bar */
        .top-bar {
            background: #065aa8;
            color: white;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }
        .top-bar a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9em;
            opacity: 0.9;
            transition: opacity 0.2s;
        }
        .top-bar a:hover { opacity: 1; }
        .top-bar-title {
            font-weight: 700;
            font-size: 1.1em;
        }
        .lang-switch {
            display: flex;
            gap: 4px;
        }
        .lang-btn {
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.2s;
        }
        .lang-btn:hover { background: rgba(255,255,255,0.25); }
        .lang-btn.active {
            background: white;
            color: #065aa8;
            border-color: white;
        }

        /* Score display */
        .score-display {
            text-align: center;
            padding: 24px 20px;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-bottom: 2px solid #bfdbfe;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .score-number {
            font-size: 3em;
            font-weight: 800;
            color: #065aa8;
            line-height: 1;
        }
        .score-label {
            font-size: 0.9em;
            color: #64748b;
            margin-bottom: 4px;
        }
        .score-status {
            margin-top: 8px;
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            display: inline-block;
        }
        .status-default { background: #f1f5f9; color: #64748b; }
        .status-insufficient { background: #fee2e2; color: #dc2626; }
        .status-pass70 { background: #dcfce7; color: #16a34a; }
        .status-pass80 { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #b45309; }

        /* Tabs */
        .category-tabs {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
        }
        .tab-btn {
            flex: 1;
            padding: 14px 8px;
            background: #f8fafc;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            color: #64748b;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }
        .tab-btn:hover { background: #eff6ff; color: #065aa8; }
        .tab-btn.active {
            background: white;
            color: #065aa8;
            border-bottom-color: #065aa8;
        }

        /* Form */
        .form-area { padding: 24px; }
        .form-section {
            margin-bottom: 20px;
            background: #f8fafc;
            border-radius: 12px;
            padding: 18px;
            border: 1px solid #e2e8f0;
        }
        .form-section-title {
            font-weight: 700;
            color: #1e40af;
            font-size: 1em;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #dbeafe;
        }
        .form-group {
            margin-bottom: 12px;
        }
        .form-group:last-child { margin-bottom: 0; }
        .form-group label {
            display: block;
            font-weight: 600;
            font-size: 0.85em;
            color: #334155;
            margin-bottom: 4px;
        }
        .form-group select,
        .form-group input[type="number"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: inherit;
            background: white;
            transition: border-color 0.2s;
        }
        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 500;
            font-size: 0.85em;
            cursor: pointer;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background: white;
            transition: all 0.2s;
        }
        .checkbox-group label:hover {
            border-color: #93c5fd;
            background: #eff6ff;
        }
        .checkbox-group input[type="checkbox"] {
            accent-color: #065aa8;
        }
        .salary-note {
            font-size: 0.8em;
            color: #b45309;
            background: #fffbeb;
            padding: 6px 10px;
            border-radius: 6px;
            margin-bottom: 8px;
            border: 1px solid #fde68a;
        }

        /* University search */
        .uni-search-wrap {
            margin-top: 8px;
            position: relative;
        }
        .uni-search-wrap input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: inherit;
            background: white;
            transition: border-color 0.2s;
        }
        .uni-search-wrap input[type="text"]:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        .uni-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin-top: 4px;
            background: white;
            display: none;
        }
        .uni-results.show { display: block; }
        .uni-result-item {
            padding: 6px 12px;
            font-size: 0.85em;
            cursor: pointer;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .uni-result-item:hover { background: #eff6ff; }
        .uni-result-item:last-child { border-bottom: none; }
        .uni-result-country {
            font-size: 0.75em;
            color: #64748b;
            white-space: nowrap;
            margin-left: 8px;
        }
        .uni-match-yes {
            color: #16a34a;
            font-weight: 600;
            font-size: 0.85em;
            margin-top: 6px;
        }
        .uni-match-no {
            color: #dc2626;
            font-size: 0.85em;
            margin-top: 6px;
        }

        /* Buttons */
        .btn-area {
            text-align: center;
            padding: 0 24px 24px;
        }
        .reset-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 10px 32px;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .reset-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(239,68,68,0.3);
        }

        /* Footer */
        .calc-footer {
            background: #065aa8;
            color: white;
            text-align: center;
            padding: 16px;
            font-size: 0.85em;
        }
        .calc-footer a { color: #93c5fd; }

        /* Bilingual toggle */
        [data-lang="zh"] { display: none; }
        body.lang-zh [data-lang="ja"] { display: none; }
        body.lang-zh [data-lang="zh"] { display: initial; }
        body.lang-zh .form-section [data-lang="zh"],
        body.lang-zh .checkbox-group [data-lang="zh"],
        body.lang-zh .score-display [data-lang="zh"] { display: initial; }
        body.lang-zh .form-section [data-lang="ja"],
        body.lang-zh .checkbox-group [data-lang="ja"],
        body.lang-zh .score-display [data-lang="ja"] { display: none; }
        .bilingual-block [data-lang="zh"] { display: none; }
        .bilingual-block [data-lang="ja"] { display: block; }
        body.lang-zh .bilingual-block [data-lang="zh"] { display: block; }
        body.lang-zh .bilingual-block [data-lang="ja"] { display: none; }

        /* Hidden sections for category */
        .category-section { display: none; }
        .category-section.active { display: block; }

        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .form-area { padding: 16px; }
            .form-section { padding: 14px; }
            .score-number { font-size: 2.5em; }
            .tab-btn { font-size: 0.8em; padding: 10px 4px; }
        }
        @media (max-width: 480px) {
            body { padding: 8px; }
            .top-bar { padding: 10px 16px; font-size: 0.85em; }
            .form-area { padding: 12px; }
            .form-section { padding: 12px; }
            .score-number { font-size: 2em; }
            .tab-btn { font-size: 0.75em; padding: 8px 2px; }
            .checkbox-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Top bar -->
        <div class="top-bar">
            <a href="index.html">&larr; <span data-lang="ja">トップページへ</span><span data-lang="zh">返回首页</span></a>
            <span class="top-bar-title">
                <span data-lang="ja">高度人材ポイント計算</span>
                <span data-lang="zh">高级人才积分计算</span>
            </span>
            <div class="lang-switch">
                <button class="lang-btn active" onclick="setLang('ja')">日本語</button>
                <button class="lang-btn" onclick="setLang('zh')">中文</button>
            </div>
        </div>

        <!-- Score display -->
        <div class="score-display">
            <div class="score-label">
                <span data-lang="ja">現在のポイント</span>
                <span data-lang="zh">当前积分</span>
            </div>
            <div class="score-number" id="score-number">0</div>
            <div>
                <span class="score-status status-default" id="score-status">
                    <span data-lang="ja">情報を入力してください</span>
                    <span data-lang="zh">请输入信息计算积分</span>
                </span>
            </div>
        </div>

        <!-- Category tabs -->
        <div class="category-tabs">
            <button class="tab-btn active" data-cat="academic" onclick="switchCategory('academic')">
                <span data-lang="ja">イ 学術研究</span>
                <span data-lang="zh">イ 学术研究</span>
            </button>
            <button class="tab-btn" data-cat="technical" onclick="switchCategory('technical')">
                <span data-lang="ja">ロ 専門技術</span>
                <span data-lang="zh">ロ 专门技术</span>
            </button>
            <button class="tab-btn" data-cat="business" onclick="switchCategory('business')">
                <span data-lang="ja">ハ 経営・管理</span>
                <span data-lang="zh">ハ 经营管理</span>
            </button>
        </div>

        <!-- Form -->
        <div class="form-area">

            <!-- Education -->
            <div class="form-section">
                <div class="form-section-title">
                    <span data-lang="ja">① 学歴</span>
                    <span data-lang="zh">① 学历</span>
                </div>
                <div class="form-group">
                    <select id="education" onchange="calculate()">
                        <!-- populated by JS -->
                    </select>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="dual-degree" onchange="calculate()">
                            <span data-lang="ja">複数の分野における２以上の博士・修士・専門職学位（+5点）</span>
                            <span data-lang="zh">多领域2个以上博士/硕士/专门职学位（+5分）</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Work experience -->
            <div class="form-section">
                <div class="form-section-title">
                    <span data-lang="ja">② 職歴（実務経験年数）</span>
                    <span data-lang="zh">② 工作经历（实际工作年数）</span>
                </div>
                <div class="form-group">
                    <select id="experience" onchange="calculate()">
                        <!-- populated by JS -->
                    </select>
                </div>
            </div>

            <!-- Age (イ/ロ only) -->
            <div class="form-section category-section" id="age-section" data-categories="academic,technical">
                <div class="form-section-title">
                    <span data-lang="ja">年齢（年収計算用）</span>
                    <span data-lang="zh">年龄（年收入计算用）</span>
                </div>
                <div class="form-group">
                    <select id="age" onchange="updateSalaryNote(); calculate()">
                        <option value="" data-ja="選択してください" data-zh="请选择">選択してください</option>
                        <option value="under30" data-ja="29歳以下（15点）" data-zh="29岁以下（15分）">29歳以下（15点）</option>
                        <option value="30to34" data-ja="30〜34歳（10点）" data-zh="30〜34岁（10分）">30〜34歳（10点）</option>
                        <option value="35to39" data-ja="35〜39歳（5点）" data-zh="35〜39岁（5分）">35〜39歳（5点）</option>
                        <option value="40plus" data-ja="40歳以上（0点）" data-zh="40岁以上（0分）">40歳以上（0点）</option>
                    </select>
                </div>
            </div>

            <!-- Annual salary (イ/ロ: age-dependent) -->
            <div class="form-section category-section" id="salary-at-section" data-categories="academic,technical">
                <div class="form-section-title">
                    <span data-lang="ja">③ 年収</span>
                    <span data-lang="zh">③ 年收入</span>
                </div>
                <div class="salary-note" id="salary-note" style="display:none;"></div>
                <div class="form-group">
                    <select id="salary-at" onchange="calculate()">
                        <option value="" data-ja="選択してください" data-zh="请选择">選択してください</option>
                        <option value="1000" data-ja="1,000万円以上（40点）" data-zh="1000万以上（40分）">1,000万円以上（40点）</option>
                        <option value="900" data-ja="900万〜1,000万円未満（35点）" data-zh="900万〜不满1000万（35分）">900万〜1,000万円未満（35点）</option>
                        <option value="800" data-ja="800万〜900万円未満（30点）" data-zh="800万〜不满900万（30分）">800万〜900万円未満（30点）</option>
                        <option value="700" data-ja="700万〜800万円未満（25点）" data-zh="700万〜不满800万（25分）">700万〜800万円未満（25点）</option>
                        <option value="600" data-ja="600万〜700万円未満（20点）" data-zh="600万〜不满700万（20分）">600万〜700万円未満（20点）</option>
                        <option value="500" data-ja="500万〜600万円未満（15点）" data-zh="500万〜不满600万（15分）">500万〜600万円未満（15点）</option>
                        <option value="400" data-ja="400万〜500万円未満（10点）" data-zh="400万〜不满500万（10分）">400万〜500万円未満（10点）</option>
                    </select>
                </div>
                <div style="font-size:0.8em;color:#64748b;margin-top:4px;">
                    <span data-lang="ja">※ 年収が300万円に満たない場合、合計70点以上でも高度専門職としては認められません。</span>
                    <span data-lang="zh">※ 年收入不满300万日元时，即使合计70分以上也不能获得高度专门职资格。</span>
                </div>
            </div>

            <!-- Annual salary (ハ: different scale, no age dependency) -->
            <div class="form-section category-section" id="salary-biz-section" data-categories="business">
                <div class="form-section-title">
                    <span data-lang="ja">③ 年収</span>
                    <span data-lang="zh">③ 年收入</span>
                </div>
                <div class="form-group">
                    <select id="salary-biz" onchange="calculate()">
                        <option value="0" data-ja="選択してください" data-zh="请选择">選択してください</option>
                        <option value="50" data-ja="3,000万円以上（50点）" data-zh="3000万以上（50分）">3,000万円以上（50点）</option>
                        <option value="40" data-ja="2,500万〜3,000万円未満（40点）" data-zh="2500万〜不满3000万（40分）">2,500万〜3,000万円未満（40点）</option>
                        <option value="30" data-ja="2,000万〜2,500万円未満（30点）" data-zh="2000万〜不满2500万（30分）">2,000万〜2,500万円未満（30点）</option>
                        <option value="20" data-ja="1,500万〜2,000万円未満（20点）" data-zh="1500万〜不满2000万（20分）">1,500万〜2,000万円未満（20点）</option>
                        <option value="10" data-ja="1,000万〜1,500万円未満（10点）" data-zh="1000万〜不满1500万（10分）">1,000万〜1,500万円未満（10点）</option>
                    </select>
                </div>
                <div style="font-size:0.8em;color:#64748b;margin-top:4px;">
                    <span data-lang="ja">※ 年収が300万円に満たない場合、合計70点以上でも高度専門職としては認められません。</span>
                    <span data-lang="zh">※ 年收入不满300万日元时，即使合计70分以上也不能获得高度专门职资格。</span>
                </div>
            </div>

            <!-- 地位 Position (ハ only) -->
            <div class="form-section category-section" id="position-section" data-categories="business">
                <div class="form-section-title">
                    <span data-lang="ja">⑳ 地位</span>
                    <span data-lang="zh">⑳ 职位</span>
                </div>
                <div class="form-group">
                    <select id="position" onchange="calculate()">
                        <option value="0" data-ja="該当なし" data-zh="无">該当なし</option>
                        <option value="10" data-ja="代表取締役，代表執行役又は代表権のある業務執行社員（10点）" data-zh="代表董事、代表执行役或有代表权的业务执行社员（10分）">代表取締役，代表執行役又は代表権のある業務執行社員（10点）</option>
                        <option value="5" data-ja="取締役，執行役又は業務執行社員（5点）" data-zh="董事、执行役或业务执行社员（5分）">取締役，執行役又は業務執行社員（5点）</option>
                    </select>
                </div>
            </div>

            <!-- Research achievements (イ: Academic) -->
            <div class="form-section category-section" id="research-academic-section" data-categories="academic">
                <div class="form-section-title">
                    <span data-lang="ja">④〜⑦ 研究実績</span>
                    <span data-lang="zh">④〜⑦ 研究成果</span>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="patent-a" onchange="calculate()">
                            <span data-lang="ja">④ 発明者として特許を受けた発明が１件以上（20点）</span>
                            <span data-lang="zh">④ 作为发明者获得专利的发明1件以上（20分）</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <div style="font-size:0.85em;color:#334155;font-weight:600;margin-bottom:6px;">
                        <span data-lang="ja">以下のうち2つ以上に該当する場合 25点</span>
                        <span data-lang="zh">以下项目中符合2项以上时 25分</span>
                    </div>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="grant-a" onchange="calculate()">
                            <span data-lang="ja">⑤ 外国政府から補助金，競争的資金等を受けた研究に３回以上従事</span>
                            <span data-lang="zh">⑤ 3次以上参与获得外国政府补助金、竞争性资金等的研究</span>
                        </label>
                        <label>
                            <input type="checkbox" id="papers-a" onchange="calculate()">
                            <span data-lang="ja">⑥ 学術論文データベースに登載されている学術雑誌に掲載された論文が３本以上（※責任著者に限る）</span>
                            <span data-lang="zh">⑥ 学术论文数据库收录的学术期刊论文3篇以上（※限责任作者）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="other-research-a" onchange="calculate()">
                            <span data-lang="ja">⑦ その他法務大臣が認める研究実績</span>
                            <span data-lang="zh">⑦ 其他法务大臣认定的研究成果</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Research achievements (ロ: Technical) -->
            <div class="form-section category-section" id="research-technical-section" data-categories="technical">
                <div class="form-section-title">
                    <span data-lang="ja">④〜⑦ 研究実績</span>
                    <span data-lang="zh">④〜⑦ 研究成果</span>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="patent-t" onchange="calculate()">
                            <span data-lang="ja">④ 発明者として特許を受けた発明が１件以上（15点）</span>
                            <span data-lang="zh">④ 作为发明者获得专利的发明1件以上（15分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="grant-t" onchange="calculate()">
                            <span data-lang="ja">⑤ 外国政府から補助金，競争的資金等を受けた研究に３回以上従事（15点）</span>
                            <span data-lang="zh">⑤ 3次以上参与获得外国政府补助金、竞争性资金等的研究（15分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="papers-t" onchange="calculate()">
                            <span data-lang="ja">⑥ 学術論文データベースに登載されている学術雑誌に掲載された論文が３本以上（15点）（※責任著者に限る）</span>
                            <span data-lang="zh">⑥ 学术论文数据库收录的学术期刊论文3篇以上（15分）（※限责任作者）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="other-research-t" onchange="calculate()">
                            <span data-lang="ja">⑦ その他法務大臣が認める研究実績（15点）</span>
                            <span data-lang="zh">⑦ 其他法务大臣认定的研究成果（15分）</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- 資格 Qualifications (ロ only) -->
            <div class="form-section category-section" id="qualification-section" data-categories="technical">
                <div class="form-section-title">
                    <span data-lang="ja">⑧ 資格</span>
                    <span data-lang="zh">⑧ 资格</span>
                </div>
                <div class="form-group">
                    <label>
                        <span data-lang="ja">従事しようとする業務に関連する日本の国家資格（業務独占資格又は名称独占資格）を保有，又はIT告示に定める試験に合格し若しくは資格を保有</span>
                        <span data-lang="zh">持有与拟从事业务相关的日本国家资格（业务独占资格或名称独占资格），或通过IT告示规定的考试或持有相关资格</span>
                    </label>
                    <select id="national-qual" onchange="calculate()">
                        <option value="0" data-ja="なし" data-zh="无">なし</option>
                        <option value="5" data-ja="1つ保有（5点）" data-zh="持有1个（5分）">1つ保有（5点）</option>
                        <option value="10" data-ja="複数保有（10点）" data-zh="持有多个（10分）">複数保有（10点）</option>
                    </select>
                </div>
            </div>

            <!-- Japanese language -->
            <div class="form-section">
                <div class="form-section-title">
                    <span data-lang="ja">⑮ 日本語能力</span>
                    <span data-lang="zh">⑮ 日语能力</span>
                </div>
                <div class="form-group">
                    <select id="japanese" onchange="calculate()">
                        <option value="0" data-ja="該当なし" data-zh="无">該当なし</option>
                        <option value="15" data-ja="Ⅰ 日本語専攻で外国の大学を卒業又は日本語能力試験Ｎ１合格相当（15点）" data-zh="Ⅰ 日语专业外国大学毕业或日语能力考试N1合格同等（15分）">Ⅰ 日本語専攻で外国の大学を卒業又は日本語能力試験Ｎ１合格相当（15点）</option>
                        <option value="10" data-ja="Ⅱ 日本語能力試験Ｎ２合格相当（10点）※⑭及びⅠに該当する者を除く" data-zh="Ⅱ 日语能力考试N2合格同等（10分）※⑭及Ⅰ符合者除外">Ⅱ 日本語能力試験Ｎ２合格相当（10点）※⑭及びⅠに該当する者を除く</option>
                    </select>
                </div>
            </div>

            <!-- Bonus: common to all categories -->
            <div class="form-section">
                <div class="form-section-title">
                    <span data-lang="ja">特別加算</span>
                    <span data-lang="zh">特别加分</span>
                </div>
                <div class="form-group">
                    <div style="font-size:0.85em;color:#334155;font-weight:600;margin-bottom:6px;">
                        <span data-lang="ja">契約機関（活動機関）</span>
                        <span data-lang="zh">签约机构（活动机构）</span>
                    </div>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="innovation" onchange="calculate()">
                            <span data-lang="ja">⑨ Ⅰ イノベーション促進支援措置を受けている（+10点）</span>
                            <span data-lang="zh">⑨ Ⅰ 接受创新促进支援措施（+10分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="innovation-sme" onchange="calculate()">
                            <span data-lang="ja">⑩ Ⅱ Ⅰに該当する企業であって，中小企業基本法に規定する中小企業者（+10点）</span>
                            <span data-lang="zh">⑩ Ⅱ 符合Ⅰ的企业，且为中小企业基本法规定的中小企业（+10分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="local-gov" onchange="calculate()">
                            <span data-lang="ja">⑪ Ⅲ 地方公共団体における高度人材外国人の受入れを促進するための支援として法務大臣が認めるものを受けている（+10点）</span>
                            <span data-lang="zh">⑪ Ⅲ 接受法务大臣认定的地方政府促进接收高级人才外国人的支援（+10分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="rd-expense" onchange="calculate()">
                            <span data-lang="ja">⑫ 契約機関が中小企業者で，試験研究費及び開発費の合計金額が売上高の３％超（+5点）</span>
                            <span data-lang="zh">⑫ 签约机构为中小企业，试验研究费及开发费合计金额超过销售额3%（+5分）</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="foreign-qual" onchange="calculate()">
                            <span data-lang="ja">⑬ 従事しようとする業務に関連する外国の資格，表彰等で法務大臣が認めるものを保有（+5点）</span>
                            <span data-lang="zh">⑬ 持有与拟从事业务相关的、法务大臣认定的外国资格/表彰等（+5分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="jp-university" onchange="calculate()">
                            <span data-lang="ja">⑭ 日本の大学を卒業又は大学院の課程を修了（+10点）</span>
                            <span data-lang="zh">⑭ 日本大学毕业或完成研究生课程（+10分）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="growth-field" onchange="calculate()">
                            <span data-lang="ja">⑯ 各省が関与する成長分野の先端プロジェクトに従事（+10点）</span>
                            <span data-lang="zh">⑯ 从事各省参与的增长领域尖端项目（+10分）</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <div style="font-size:0.85em;color:#334155;font-weight:600;margin-bottom:6px;">
                        <span data-lang="ja">⑰ 以下のいずれかの大学を卒業（+10点）</span>
                        <span data-lang="zh">⑰ 毕业于以下任一大学（+10分）</span>
                    </div>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="top-university" onchange="calculate()">
                            <span data-lang="ja">Ⅰ ランキング２つ以上において３００位以内の外国の大学又はいずれかにランクづけされている本邦の大学 / Ⅱ スーパーグローバル大学創成支援事業の補助金交付大学 / Ⅲ イノベーティブ・アジア事業パートナー校</span>
                            <span data-lang="zh">Ⅰ 2个以上排名中位列300名以内的外国大学或任一排名中的日本大学 / Ⅱ 超级全球化大学创成支援事业补助金交付大学 / Ⅲ 创新亚洲事业合作校</span>
                        </label>
                    </div>
                    <div class="uni-search-wrap">
                        <label style="display:block;font-weight:600;font-size:0.85em;color:#334155;margin-bottom:4px;">
                            <span data-lang="ja">大学名を検索（加点対象か確認）</span>
                            <span data-lang="zh">搜索大学名（确认是否加分对象）</span>
                        </label>
                        <input type="text" id="uni-search" placeholder="例: 北京理工大学 / Beijing Institute of Technology" oninput="searchUniversity()" onfocus="searchUniversity()">
                        <div class="uni-results" id="uni-results"></div>
                        <div id="uni-match-msg"></div>
                    </div>
                    <div style="font-size:0.75em;color:#64748b;margin-top:4px;">
                        <span data-lang="ja">※ 日本の大学卒業（+10点）と重複加算が認められています。</span>
                        <span data-lang="zh">※ 可与日本大学毕业（+10分）重复计算。</span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="jica" onchange="calculate()">
                            <span data-lang="ja">⑱ 外務省が実施するイノベーティブ・アジア事業の一環としてＪＩＣＡが実施する研修を修了したこと（+5点）</span>
                            <span data-lang="zh">⑱ 完成外务省实施的创新亚洲事业中JICA实施的培训（+5分）</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Bonus: ロ/ハ only - 投資運用業 -->
            <div class="form-section category-section" id="invest-mgmt-section" data-categories="technical,business">
                <div class="form-section-title">
                    <span data-lang="ja">特別加算（ロ・ハ共通）</span>
                    <span data-lang="zh">特别加分（ロ・ハ共通）</span>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="invest-mgmt" onchange="calculate()">
                            <span data-lang="ja">㉑ 投資運用業等に係る業務に従事（+10点）</span>
                            <span data-lang="zh">㉑ 从事投资运用业务（+10分）</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Bonus: ハ only - 投資 -->
            <div class="form-section category-section" id="invest-section" data-categories="business">
                <div class="form-section-title">
                    <span data-lang="ja">特別加算（ハのみ）</span>
                    <span data-lang="zh">特别加分（仅限ハ）</span>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="invest-100m" onchange="calculate()">
                            <span data-lang="ja">⑲ 本邦の公私の機関において行う貿易その他の事業に１億円以上を投資（+5点）</span>
                            <span data-lang="zh">⑲ 向日本公私机构从事的贸易及其他事业投资1亿日元以上（+5分）</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="btn-area">
            <button class="reset-btn" onclick="resetForm()">
                <span data-lang="ja">リセット</span>
                <span data-lang="zh">重置</span>
            </button>
        </div>

        <div class="calc-footer">
            <span data-lang="ja">※ この計算結果は参考値です。正式な審査結果とは異なる場合があります。</span>
            <span data-lang="zh">※ 本计算结果仅供参考，可能与正式审查结果不同。</span>
            <br>
            <a href="https://www.moj.go.jp/isa/publications/materials/newimmiact_3_evaluate_index.html" target="_blank">
                <span data-lang="ja">出入国在留管理庁公式ページ</span>
                <span data-lang="zh">出入国在留管理厅官方页面</span>
            </a>
        </div>
    </div>

    <script>
        let currentCategory = 'academic';
        let currentLang = 'ja';

        // Category-specific option definitions
        const eduOptions = {
            academic: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '30', ja: '博士学位（専門職学位を除く）（30点）', zh: '博士学位（不含专门职学位）（30分）' },
                { val: '20', ja: '修士又は専門職学位（20点）', zh: '硕士或专门职学位（20分）' },
                { val: '10', ja: '大卒又はこれと同等以上の教育（10点）', zh: '大学本科或同等以上教育（10分）' }
            ],
            technical: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '30', ja: '博士学位（専門職学位を除く）（30点）', zh: '博士学位（不含专门职学位）（30分）' },
                { val: '25', ja: '経営管理に関する専門職学位（MBA，MOT）を保有（25点）', zh: '持有经营管理专门职学位（MBA/MOT）（25分）' },
                { val: '20', ja: '修士又は専門職学位（20点）', zh: '硕士或专门职学位（20分）' },
                { val: '10', ja: '大卒又はこれと同等以上の教育（10点）', zh: '大学本科或同等以上教育（10分）' }
            ],
            business: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '25', ja: '経営管理に関する専門職学位（MBA，MOT）を保有（25点）', zh: '持有经营管理专门职学位（MBA/MOT）（25分）' },
                { val: '20', ja: '博士若しくは修士の学位又は専門職学位（20点）', zh: '博士/硕士学位或专门职学位（20分）' },
                { val: '10', ja: '大卒又はこれと同等以上の教育（10点）', zh: '大学本科或同等以上教育（10分）' }
            ]
        };

        const expOptions = {
            academic: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '0_under3', ja: '3年未満（0点）', zh: '不满3年（0分）' },
                { val: '5', ja: '3年以上〜5年未満（5点）', zh: '3年以上〜不满5年（5分）' },
                { val: '10', ja: '5年以上〜7年未満（10点）', zh: '5年以上〜不满7年（10分）' },
                { val: '15', ja: '7年以上（15点）', zh: '7年以上（15分）' }
            ],
            technical: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '0_under3', ja: '3年未満（0点）', zh: '不满3年（0分）' },
                { val: '5', ja: '3年以上〜5年未満（5点）', zh: '3年以上〜不满5年（5分）' },
                { val: '10', ja: '5年以上〜7年未満（10点）', zh: '5年以上〜不满7年（10分）' },
                { val: '15', ja: '7年以上〜10年未満（15点）', zh: '7年以上〜不满10年（15分）' },
                { val: '20', ja: '10年以上（20点）', zh: '10年以上（20分）' }
            ],
            business: [
                { val: '0', ja: '選択してください', zh: '请选择' },
                { val: '0_under3', ja: '3年未満（0点）', zh: '不满3年（0分）' },
                { val: '10', ja: '3年以上〜5年未満（10点）', zh: '3年以上〜不满5年（10分）' },
                { val: '15', ja: '5年以上〜7年未満（15点）', zh: '5年以上〜不满7年（15分）' },
                { val: '20', ja: '7年以上〜10年未満（20点）', zh: '7年以上〜不满10年（20分）' },
                { val: '25', ja: '10年以上（25点）', zh: '10年以上（25分）' }
            ]
        };

        // Salary table for イ/ロ: salaryRange -> { ageGroup -> points }
        // "-" means not eligible (0 points)
        const salaryTableAT = {
            '1000': { under30: 40, '30to34': 40, '35to39': 40, '40plus': 40 },
            '900':  { under30: 35, '30to34': 35, '35to39': 35, '40plus': 35 },
            '800':  { under30: 30, '30to34': 30, '35to39': 30, '40plus': 30 },
            '700':  { under30: 25, '30to34': 25, '35to39': 25, '40plus': 0 },
            '600':  { under30: 20, '30to34': 20, '35to39': 20, '40plus': 0 },
            '500':  { under30: 15, '30to34': 15, '35to39': 0,  '40plus': 0 },
            '400':  { under30: 10, '30to34': 0,  '35to39': 0,  '40plus': 0 }
        };

        const agePoints = { under30: 15, '30to34': 10, '35to39': 5, '40plus': 0 };

        function setLang(lang) {
            currentLang = lang;
            document.body.classList.toggle('lang-zh', lang === 'zh');
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.lang-btn[onclick="setLang('${lang}')"]`).classList.add('active');

            // Update select option texts
            document.querySelectorAll('select').forEach(sel => {
                sel.querySelectorAll('option').forEach(opt => {
                    const text = opt.getAttribute('data-' + lang);
                    if (text) opt.textContent = text;
                });
            });

            // Re-populate category-specific dropdowns
            populateDropdowns();
            updateSalaryNote();
            calculate();
        }

        function populateDropdowns() {
            populateSelect('education', eduOptions[currentCategory]);
            populateSelect('experience', expOptions[currentCategory]);
        }

        function populateSelect(id, options) {
            const sel = document.getElementById(id);
            const prevVal = sel.value;
            sel.innerHTML = '';
            options.forEach(opt => {
                const o = document.createElement('option');
                o.value = opt.val;
                o.textContent = currentLang === 'zh' ? opt.zh : opt.ja;
                o.setAttribute('data-ja', opt.ja);
                o.setAttribute('data-zh', opt.zh);
                sel.appendChild(o);
            });
            // Try to restore previous value
            if ([...sel.options].some(o => o.value === prevVal)) {
                sel.value = prevVal;
            }
        }

        function switchCategory(cat) {
            currentCategory = cat;
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.cat === cat);
            });

            // Show/hide category-specific sections
            document.querySelectorAll('.category-section').forEach(section => {
                const cats = section.dataset.categories.split(',');
                section.classList.toggle('active', cats.includes(cat));
            });

            populateDropdowns();
            updateSalaryNote();
            calculate();
        }

        function getSelectValue(id) {
            return document.getElementById(id).value;
        }

        function getSelectPoints(id) {
            const val = document.getElementById(id).value;
            const num = parseInt(val);
            return isNaN(num) ? 0 : num;
        }

        function isChecked(id) {
            return document.getElementById(id).checked;
        }

        function updateSalaryNote() {
            const noteEl = document.getElementById('salary-note');
            const age = getSelectValue('age');
            if (!age) {
                noteEl.style.display = 'none';
                return;
            }
            const ineligible = [];
            if (age === '40plus') {
                ineligible.push('700万円未満');
            } else if (age === '35to39') {
                ineligible.push('600万円未満');
            } else if (age === '30to34') {
                ineligible.push('500万円未満');
            }
            if (ineligible.length > 0) {
                noteEl.style.display = 'block';
                if (currentLang === 'zh') {
                    noteEl.textContent = '⚠ 您的年龄段中，年收入' + ineligible[0].replace('万円未満','万日元以下') + '不计分';
                } else {
                    noteEl.textContent = '⚠ お選びの年齢では、年収' + ineligible[0] + 'はポイント対象外です';
                }
            } else {
                noteEl.style.display = 'none';
            }
        }

        function calculate() {
            let total = 0;

            // Education
            total += getSelectPoints('education');
            if (isChecked('dual-degree')) total += 5;

            // Experience
            total += getSelectPoints('experience');

            // Age (イ/ロ only)
            if (currentCategory === 'academic' || currentCategory === 'technical') {
                const age = getSelectValue('age');
                if (age && agePoints[age] !== undefined) {
                    total += agePoints[age];
                }

                // Salary (イ/ロ: age-dependent)
                const salaryRange = getSelectValue('salary-at');
                if (salaryRange && age && salaryTableAT[salaryRange]) {
                    total += salaryTableAT[salaryRange][age] || 0;
                }
            }

            // Salary (ハ)
            if (currentCategory === 'business') {
                total += getSelectPoints('salary-biz');
            }

            // Position (ハ only)
            if (currentCategory === 'business') {
                total += getSelectPoints('position');
            }

            // Research (イ: Academic)
            if (currentCategory === 'academic') {
                if (isChecked('patent-a')) total += 20;
                // 補助金/論文/その他: 2つ以上該当で25点
                let researchCount = 0;
                if (isChecked('grant-a')) researchCount++;
                if (isChecked('papers-a')) researchCount++;
                if (isChecked('other-research-a')) researchCount++;
                if (researchCount >= 2) total += 25;
            }

            // Research (ロ: Technical) - each 15 points
            if (currentCategory === 'technical') {
                if (isChecked('patent-t')) total += 15;
                if (isChecked('grant-t')) total += 15;
                if (isChecked('papers-t')) total += 15;
                if (isChecked('other-research-t')) total += 15;
            }

            // 資格 (ロ only)
            if (currentCategory === 'technical') {
                total += getSelectPoints('national-qual');
            }

            // Japanese language
            total += getSelectPoints('japanese');

            // Bonus: common
            if (isChecked('innovation')) total += 10;
            if (isChecked('innovation-sme')) total += 10;
            if (isChecked('local-gov')) total += 10;
            if (isChecked('rd-expense')) total += 5;
            if (isChecked('foreign-qual')) total += 5;
            if (isChecked('jp-university')) total += 10;
            if (isChecked('growth-field')) total += 10;
            if (isChecked('top-university')) total += 10;
            if (isChecked('jica')) total += 5;

            // 投資運用業 (ロ/ハ)
            if (currentCategory === 'technical' || currentCategory === 'business') {
                if (isChecked('invest-mgmt')) total += 10;
            }

            // 投資1億円 (ハ only)
            if (currentCategory === 'business') {
                if (isChecked('invest-100m')) total += 5;
            }

            updateScoreDisplay(total);
        }

        function updateScoreDisplay(total) {
            const scoreEl = document.getElementById('score-number');
            const statusEl = document.getElementById('score-status');

            scoreEl.textContent = total;

            if (total === 0) {
                statusEl.className = 'score-status status-default';
                if (currentLang === 'zh') {
                    statusEl.innerHTML = '请输入信息计算积分';
                } else {
                    statusEl.innerHTML = '情報を入力してください';
                }
            } else if (total < 70) {
                const need = 70 - total;
                statusEl.className = 'score-status status-insufficient';
                if (currentLang === 'zh') {
                    statusEl.innerHTML = `不足70分（还需${need}分）`;
                } else {
                    statusEl.innerHTML = `70点未満（あと${need}点必要）`;
                }
            } else if (total < 80) {
                statusEl.className = 'score-status status-pass70';
                if (currentLang === 'zh') {
                    statusEl.innerHTML = '可取得高度专门职1号签证（3年后可申请永住）';
                } else {
                    statusEl.innerHTML = '高度専門職1号取得可能（3年後に永住申請可）';
                }
            } else {
                statusEl.className = 'score-status status-pass80';
                if (currentLang === 'zh') {
                    statusEl.innerHTML = '80分以上！1年后可申请永住';
                } else {
                    statusEl.innerHTML = '80点以上！1年後に永住申請可能';
                }
            }
        }

        function resetForm() {
            document.querySelectorAll('select').forEach(sel => sel.selectedIndex = 0);
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('uni-search').value = '';
            document.getElementById('uni-results').classList.remove('show');
            document.getElementById('uni-match-msg').innerHTML = '';
            document.getElementById('salary-note').style.display = 'none';
            calculate();
        }

        // University search data (from official MOJ list, January 2026)
        // Format: [English name, Japanese name, Country]
        const uniData = [["Trinity College Dublin,T he University of Dublin","ダブリン大学 トリニティ・カレッジ","アイルランド"],["Universiti Teknologi PETRONAS (UTP)","ペトロナス工科大学","アイルランド"],["Khalifa University","ハリーファ大学","アラブ首長国連邦"],["United Arab Emir ates University","アラブ首長国連邦大学","アラブ首長国連邦"],["University of Buenos Aires (Universidad de Buenos Aires (UBA))","ブエノスアイレス大学","アルゼンチン"],["Cardiff Univ ersity","カーディフ大学","イギリス"],["Durham University","ダラム大学","イギリス"],["Imperial College London","インペリアル・カレッジ・ロンドン","イギリス"],["King's College London","キングス・カレッジ・ロンドン","イギリス"],["Lancaster University","ランカスター大学","イギリス"],["London School of Economics and Political Science","ロンドン・スクール・オブ・エコノ ミクス・アンド・ポリティカル・サイエンス","イギリス"],["Newcastle University","ニューカッスル大学","イギリス"],["Queen Mary University of London","ロンドン大学クイーンメアリー","イギリス"],["Queen's University Belfast","クイーンズ大学ベルファスト","イギリス"],["The University of Edinburgh","エディンバラ大学","イギリス"],["The University of Glasgow","グラスゴー大学","イギリス"],["The University of Manchester","マンチェスター大学","イギリス"],["The University of Sheffield","シェフィールド大学","イギリス"],["The University of Warwick","ウォーリック大学","イギリス"],["University College London(UCL)","ユニバーシティ・カレッジ・ロンド ン（UCL)","イギリス"],["University of Aberdeen","アバディーン大学","イギリス"],["University of Bath","バース大学","イギリス"],["University of Birmingham","バーミンガム大学","イギリス"],["University of Bristol","ブリストル大学","イギリス"],["University of Cambridge","ケンブリッジ大学","イギリス"],["University of Exeter","エクセター大学","イギリス"],["University of Leeds","リーズ大学","イギリス"],["University of Liverpool","リバプール大学","イギリス"],["University of Nottingham","ノッティンガム大学","イギリス"],["University of Oxford","オックスフォード大学","イギリス"],["University of Reading","レディング大学","イギリス"],["University of Southampton","サウサンプトン大学","イギリス"],["University of St. Andrews","セント・アンドルーズ大学","イギリス"],["University of Surrey","サリー大学","イギリス"],["University of Sussex","サセックス大学","イギリス"],["University of York","ヨーク大学","イギリス"],["Tel Aviv University","テルアビブ大学","イスラエル"],["The Hebrew University of Jerusalem","エルサレム・ヘブライ大学","イスラエル"],["Polytechnic University of Milan (Politecnico di Milano )","ミラノ工科大学","イタリア"],["Sapienza University of Rome","ローマ・ラ・サピエンツァ大学","イタリア"],["University of Bologna (Alma Mater Stud iorum - Universi t","ボローニャ大学","イタリア"],["University of Milan","ミラノ大学","イタリア"],["University of Padua","パドヴァ大学","イタリア"],["Indian Institute of Science","インド理科大学院大学","インド"],["Delft University of Technology","デルフト工科大学","オランダ"],["Eindhoven University of Technology","アイントホーフェン工科大学","オランダ"],["Erasmus University Rotterdam","エラスムス大学","オランダ"],["Leiden University","ライデン大学","オランダ"],["Maastricht University","マーストリヒト大学","オランダ"],["Radboud University Nijmegen","ラドバウド大学","オランダ"],["University of Amsterdam","アムステルダム大学","オランダ"],["University of Groningen","フローニンゲン大学","オランダ"],["University of Twente","トゥウェンテ大学","オランダ"],["Utrecht University","ユトレヒト大学","オランダ"],["Vrije Universi teit Amsterdam","アムステルダム自由大学","オランダ"],["Wageningen University & Research","ワーゲニンゲン大学","オランダ"],["Curtin University","カーティン大学","オーストラリア"],["Deakin University","ディーキン大学","オーストラリア"],["Griffith University","グリフィス大学","オーストラリア"],["La Trobe University","ラ・トローブ大学","オーストラリア"],["Macquarie University","マッコーリー大学","オーストラリア"],["Monash University","モナシュ大学","オーストラリア"],["Queensland University of Technology (QUT)","クイーンズランド工科大学","オーストラリア"],["RMIT University","ロイヤルメルボルン工科大学","オーストラリア"],["Swinburne University of Technology","スインバン大学","オーストラリア"],["The Australian National University","オーストラリア国立大学","オーストラリア"],["The University of Adelaide","アデレード大学","オーストラリア"],["The University of Melbourne","メルボルン大学","オーストラリア"],["The University of New South Wales","ニューサウスウェールズ大学","オーストラリア"],["The University of Newcastle, Australia (UoN)","ニューカッスル大学 (オーストラリア)","オーストラリア"],["The University of Queensland","クイーンズランド大学","オーストラリア"],["The University of Sydney","シドニー大学","オーストラリア"],["The University of Western Australia","西オーストラリア大学","オーストラリア"],["University of Technology Sydney","シドニー工科大学","オーストラリア"],["University of Wollongong","ウーロンゴン大学","オーストラリア"],["Medical University of Vienna","ウィーン医科大学","オーストリア"],["University of Vienna","ウィーン大学","オーストリア"],["Vienna University of Technology (Technische Universit","ドレスデン工科大学","オーストリア"],["Qatar University","カタール大学","カタール"],["McGill University","マギル大学","カナダ"],["McMaster University","マックマスター大学","カナダ"],["Queen's University","クイーンズ大学","カナダ"],["University of Alberta","アルバータ大学","カナダ"],["University of British Columbia","ブリティッシュコロンビア大学","カナダ"],["University of Calgary","カルガリー大学","カナダ"],["University of Montreal","（Université de Montréal） モントリオール大学","カナダ"],["University of Ottawa","オタワ大学","カナダ"],["University of Toronto","トロント大学","カナダ"],["University of Waterloo","ウォータール－大学","カナダ"],["Western University (The University of Western Ontario)","ウェスタンオンタリオ大学","カナダ"],["King Fahd University of Petroleum & Minerals(KFUPM)","ファハド国王石油鉱物大学","サウジアラビア"],["King Saud University","キングサウード大学","サウジアラビア"],["Nanyang Technological University","南洋理工大学","シンガポール"],["National University of Singapore","シンガポール国立大学","シンガポール"],["Swiss Federal Inst itute of Technology Lausanne(EPFL)(EPFL","スイス連邦工科大学ローザンヌ校","スイス"],["Swiss Federal Institute of Technology Zurich(ETH Zurich)","スイス連邦工科大学 チューリッヒ校","スイス"],["University of Basel","バーゼル大学","スイス"],["University of Bern","ベルン大学","スイス"],["University of Geneva","ジュネーブ大学","スイス"],["University of Lausanne","ローザンヌ大学","スイス"],["University of Zurich","チューリッヒ大学","スイス"],["Chalmers University of Technology","チャルマース工科大学","スウェーデン"],["KTH Royal Institute of Technology","スウェーデン王立工科大学","スウェーデン"],["Karolinska Institute","カロリンスカ研究所","スウェーデン"],["Lund University","ルンド大学","スウェーデン"],["Stockholm University","ストックフォルム大学","スウェーデン"],["University of Gothenburg","ヨーテボリ大学","スウェーデン"],["Uppsala University","ウプサラ大学","スウェーデン"],["Autonomous University of Barcelona (Universitat Aut","バルセロナ自治大学","スペイン"],["Pompeu Fabra University","ポンペウ・ファブラ大学","スペイン"],["University of Barcelona","バルセロナ大学","スペイン"],["University of Navarra","ナバーラ大学","スペイン"],["Aarhus University","オーフス大学","デンマーク"],["University of Copenhagen","コペンハーゲン大学","デンマーク"],["Free University of Berlin (Freie Universitaet Berlin)","ベルリン自由大学","ドイツ"],["Goethe University Frankfurt","ヨハン・ヴォルフガング・ゲーテ 大学フランクフルト・アム・マイン","ドイツ"],["Heidelberg University ( Universit","ハイデルベルグ大学","ドイツ"],["Heinrich Heine Universit","ハインリッヒ・ハイネ大学","ドイツ"],["Humboldt University of Berlin (Humboldt-Universit","フンボルト大学ベルリン","ドイツ"],["Karlsruhe Institute of Technology(KIT)","カールスルーエ工科大学","ドイツ"],["LMU Munich","ミュンヘン大学","ドイツ"],["RWTH Aachen University","アーヘン工科大学","ドイツ"],["Ruhr University Bochum","ルール大学ボーフム","ドイツ"],["Technical University of Berlin","ベルリン工科大学","ドイツ"],["Technical University of Darmstadt","ダルムシュタット工科大学","ドイツ"],["Technical University of Denmark","デンマーク工科大学","ドイツ"],["Technische Universit","ドレスデン工科大学","ドイツ"],["University of Bonn (Rheinische Frie drich-Wilhelms-U niversit","ボン大学","ドイツ"],["University of Cologne","ケルン大学","ドイツ"],["University of Erlangen-Nuremberg (Friedrich-Alexander-Universit","エアランゲン・ニュルンベルグ大学","ドイツ"],["University of Freiburg","フライブルク大学","ドイツ"],["University of Goettingen","ゲッティンゲン大学","ドイツ"],["University of Hamburg","ハンブルグ大学","ドイツ"],["University of Munster","ミュンスター大学","ドイツ"],["University of Tuebingen (Eberhard Karls Universit","テュービンゲン大学","ドイツ"],["University of Wuerzburg","ヴュルツブルク大学","ドイツ"],["The University of Auckland","オークランド大学","ニュージーランド"],["Norwegian University of Science and Technology","ノルウェー科学技術大学","ノルウェー"],["University of Bergen","ベルゲン大学","ノルウェー"],["University of Oslo","オスロ大学","ノルウェー"],["Aalto University","アールト大学","フィンランド"],["University of Helsinki","ヘルシンキ大学","フィンランド"],["Institut Polytechnique de Paris","パリ工科大学","フランス"],["PSL Research University Paris (PSL) PSL","PSL研究大学","フランス"],["Paris-Saclay University (Universit","パリ＝サクレー大学","フランス"],["Sorbonne University","ソルボンヌ大学","フランス"],["University of Paris Cite","パリ・シテ大学","フランス"],["University of Sao Paulo","サンパウロ大学","ブラジル"],["Catholic University of Louvain (Universit","ルーヴァン・カトリック大学","ベルギー"],["Ghent University","ゲント大学","ベルギー"],["KU Leuven","ルーベン・カトリック大学","ベルギー"],["Universit","é libre d e Bruxelles (ULB) ブリュッセル自由大学 (ULB)","ベルギー"],["University of Antwerp","アントワープ大学","ベルギー"],["Vrije Universite it Brussel (VUB)","ブリュッセル自由大学 (VUB)","ベルギー"],["University of Lisbon","リスボン大学","ポルトガル"],["University of Porto","ポルト大学","ポルトガル"],["University of Macau","マカオ大学","マカオ"],["University of Malaya","マラヤ大学","マレーシア"],["National Autonomous University of Mexico (Universidad Nacional Aut","メキシコ国立自治大学","メキシコ"],["Lomonosov Moscow State University","モスクワ大学","ロシア"],["Beihang University","北京航空航天大学","中国"],["Beijing Institute of Technology","北京理工大学","中国"],["Beijing Normal University","北京師範大学","中国"],["Central South University","中南大学","中国"],["East China Normal University","華東師範大学","中国"],["Fudan University","復旦大学","中国"],["Harbin Institute of Technology","ハルビン工業大学","中国"],["Huazhong University of Science and Technology","華中科技大学","中国"],["Hunan University","湖南大学","中国"],["Nanjing University","南京大学","中国"],["Nankai University","南開大学","中国"],["Northeastern University (Shenyang)","東北大学","中国"],["Northwestern Polytechnical University","西北工業大学","中国"],["Peking University","北京大学","中国"],["Shandong University","山東大学","中国"],["Shanghai Jiao Tong University","上海交通大学","中国"],["Sichuan University","四川大学","中国"],["South China University of Technology","華南理工大学","中国"],["Southeast University","東南大学","中国"],["Southern Medical University","南方医科大学","中国"],["Southern University of Science and Technology (SUSTech)","南方科技大学","中国"],["Sun Yat-sen University","中山大学","中国"],["Tianjin University","天津大学","中国"],["Tongji University","同済大学","中国"],["Tsinghua University","清華大学（中国）","中国"],["University of Science an d Technology of China","中国科学技術大学","中国"],["Wuhan University","武漢大学","中国"],["Xi'an Jiaotong University","西安交通大学","中国"],["Xiamen University","厦門大学","中国"],["Zhejiang University","浙江大学","中国"],["University of Cape Town","ケープタウン大学","南アフリカ共和国"],["National Taiwan University","国立台湾大学","台湾"],["Aichi Medical University","愛知医科大学","日本"],["Akita University","秋田大学","日本"],["Aoyama Gakuin University","青山学院大学","日本"],["Chiba Institute of Technology","千葉工業大学","日本"],["Chiba University","千葉大学","日本"],["Chubu University","中部大学","日本"],["Chuo University","中央大学","日本"],["Dokkyo Medical University","獨協医科大学","日本"],["Doshisha University","同志社大学","日本"],["Ehime University","愛媛大学","日本"],["Fujita Health University","藤田医科大学","日本"],["Gifu University","岐阜大学","日本"],["Gunma University","群馬大学","日本"],["Hamamatsu University School of Medicine","浜松医科大学","日本"],["Hirosaki University","弘前大学","日本"],["Hiroshima University","広島大学","日本"],["Hitotsubashi University","一橋大学","日本"],["Hokkaido University","北海道大学","日本"],["Hosei University","法政大学","日本"],["Hyogo Medical University","兵庫医科大学","日本"],["Ibaraki University","茨城大学","日本"],["Institute of Science Tokyo (Previously:Tokyo Medical and Dental University","東京科学大学","日本"],["International Christian University","国際基督教大学","日本"],["Jikei University School of Medicine","東京慈恵会医科大学","日本"],["Juntendo University","順天堂大学","日本"],["Kagawa University","香川大学","日本"],["Kagoshima University","鹿児島大学","日本"],["Kanagawa University","神奈川大学","日本"],["Kanazawa University","金沢大学","日本"],["Kansai Medical University","関西医科大学","日本"],["Kansai University","関西大学","日本"],["Keio University","慶應義塾大学","日本"],["Kindai University","（Kinki University） 近畿大学","日本"],["Kitasato University","北里大学","日本"],["Kobe University","神戸大学","日本"],["Kochi University","高知大学","日本"],["Kochi University of Technology","高知工科大学","日本"],["Kogakuin University","工学院大学","日本"],["Kumamoto University","熊本大学","日本"],["Kurume University","久留米大学","日本"],["Kwansei Gakuin University","関西学院大学","日本"],["Kyoto Institute of Technology","京都工芸繊維大学","日本"],["Kyoto Prefectural University of Medicine","京都府立医科大学","日本"],["Kyoto University","京都大学","日本"],["Kyushu Institute of Technology","九州工業大学","日本"],["Kyushu University","九州大学","日本"],["Meiji University","明治大学","日本"],["Meijo University","名城大学","日本"],["Mie University","三重大学","日本"],["Muroran Institute of Technology","室蘭工業大学","日本"],["Nagaoka University of Technology","長岡技術科学大学","日本"],["Nagasaki University","長崎大学","日本"],["Nagoya City University","名古屋市立大学","日本"],["Nagoya Institute of Technology (NIT)","名古屋工業大学","日本"],["Nagoya University","名古屋大学","日本"],["Nihon University","日本大学","日本"],["Niigata University","新潟大学","日本"],["Nippon Medical School","日本医科大学","日本"],["Ochanomizu University","お茶の水女子大学","日本"],["Oita University","大分大学","日本"],["Okayama University","岡山大学","日本"],["Okayama University of Science","岡山理科大学","日本"],["Okinawa Institute of Science and Technology Graduate University","沖縄科学技術大学院大学","日本"],["Osaka Institute of Technology","大阪工業大学","日本"],["Osaka Medical and Pharmaceutical University","大阪医科薬科大学","日本"],["Osaka Metropolitan University","大阪公立大学","日本"],["Rikkyo University","立教大学","日本"],["Ritsumeikan Asia Pacific University","立命館アジア太平洋大学","日本"],["Ritsumeikan University","立命館大学","日本"],["Ryukoku University","龍谷大学","日本"],["Saga University","佐賀大学","日本"],["Saitama Medical University","埼玉医科大学","日本"],["Saitama University","埼玉大学","日本"],["Sapporo Medical University","札幌医科大学","日本"],["Shibaura Institute of Technology","芝浦工業大学","日本"],["Shiga University of Medical Science","滋賀医科大学","日本"],["Shimane University","島根大学","日本"],["Shinshu University","信州大学","日本"],["Shizuoka University","静岡大学","日本"],["Soka University","創価大学","日本"],["Sophia University","上智大学","日本"],["Teikyo University","帝京大学","日本"],["The Graduate University for Advanced Studies, SOKENDAI","総合研究大学院大学","日本"],["The University of Electro-Communications","電気通信大学","日本"],["The University of Osaka","大阪大学","日本"],["The University of Tokyo","東京大学","日本"],["Toho University","東邦大学","日本"],["Tohoku University","東北大学","日本"],["Tokai University","東海大学","日本"],["Tokushima University","徳島大学","日本"],["Tokyo City University","東京都市大学","日本"],["Tokyo Denki University","東京電機大学","日本"],["Tokyo Medical University","東京医科大学","日本"],["Tokyo Medical and Dental University (TMDU)","東京医科歯科大学","日本"],["Tokyo Metropolitan University","東京都立大学","日本"],["Tokyo University of Agriculture","東京農業大学","日本"],["Tokyo University of Agriculture and Technology","東京農工大学","日本"],["Tokyo University of Marine Science and Technology","東京海洋大学","日本"],["Tokyo University of Science","東京理科大学","日本"],["Tokyo University of Technology","東京工科大学","日本"],["Tottori University","鳥取大学","日本"],["Toyama Prefectural University","富山県立大学","日本"],["Toyo University","東洋大学","日本"],["Toyohashi University of Technology (TUT)","豊橋技術科学大学","日本"],["University of Aizu","会津大学","日本"],["University of Fukui","福井大学","日本"],["University of Hyogo","兵庫県立大学","日本"],["University of Miyazaki","宮崎大学","日本"],["University of Occupational and Environmental Health , Japan","産業医科大学","日本"],["University of Shizuoka","静岡県立大学","日本"],["University of Toyama","富山大学","日本"],["University of Tsukuba","筑波大学","日本"],["University of Yamanashi","山梨大学","日本"],["University of the Ryukyus","琉球大学","日本"],["Utsunomiya University","宇都宮大学","日本"],["Wakayama Medical University","和歌山県立医科大学","日本"],["Waseda University","早稲田大学","日本"],["Yamagata University","山形大学","日本"],["Yamaguchi University","山口大学","日本"],["Yokohama City University","横浜市立大学","日本"],["Yokohama National University","横浜国立大学","日本"],["Arizona State University","アリゾナ州立大学","米国"],["Boston University","ボストン大学","米国"],["Brown University","ブラウン大学","米国"],["California Institute of Technology","カリフォルニア工科大学","米国"],["Carnegie Mellon University","カーネギーメロン大学","米国"],["Case Western Reserve University","ケース・ウェスターン・リザーブ 大学","米国"],["Columbia University","コロンビア大学","米国"],["Cornell University","コーネル大学","米国"],["Dartmouth College","ダートマス大学","米国"],["Duke University","デューク大学","米国"],["Emory University","エモリー大学","米国"],["Georgetown University","ジョージタウン大学","米国"],["Georgia Institute of Technology","ジョージア工科大学","米国"],["Harvard University","ハーバード大学","米国"],["Indiana University Bloomington","インディアナ大学 ブルーミントン校","米国"],["Johns Hopkins University","ジョンズ・ホプキンス大学","米国"],["Massachusetts Institute of Technology (MIT)","マサチューセッツ工科大学","米国"],["Michigan State University","ミシガン州立大学","米国"],["New York University","ニューヨーク大学","米国"],["North Carolina State University","ノースカロライナ州立大学","米国"],["Northeastern University,US","ノースイースタン大学（アメリカ）","米国"],["Northwestern University","ノースウェスタン大学","米国"],["Pennsylvania State University","ペンシルベニア州立大学","米国"],["Princeton University","プリンストン大学","米国"],["Purdue University - West Lafayette","パデュー大学","米国"],["Rice University","ライス大学","米国"],["Stanford University","スタンフォード大学","米国"],["Texas A&M University","テキサスA＆M大学","米国"],["The Ohio State University","オハイオ州立大学","米国"],["The University of Arizona","アリゾナ大学","米国"],["The University of Texas at Austin","テキサス大学オースティン校","米国"],["Tufts University","タフツ大学","米国"],["University of California, Berkeley","カリフォルニア大学 バークレー校","米国"],["University of California, Davis","カリフォルニア大学 デービス校","米国"],["University of California, Irvine","カリフォルニア大学 アーバイン校","米国"],["University of California, Los Angeles","カリフォルニア大学 ロサンゼルス校","米国"],["University of California, San Diego","カリフォルニア大学 サンディエゴ校","米国"],["University of California, Santa Barbara","カリフォルニア大学 サンタバーバラ校","米国"],["University of California, Santa Cruz","カリフォルニア大学 サンタクルーズ校","米国"],["University of Chicago","シカゴ大学","米国"],["University of Colorado at Boulder","コロラド大学ボルダー校","米国"],["University of Colorado at Denver","コロラド大学デンバー校","米国"],["University of Florida","フロリダ大学","米国"],["University of Illinois at Urbana-Champaign","イリノイ大学 アーバナ・シャンペーン校","米国"],["University of Maryland, College Park","メリーランド大学 カレッジパーク校","米国"],["University of Massachusetts Amherst","マサチューセッツ大学 アマースト校","米国"],["University of Michigan-Ann Arbor","ミシガン大学","米国"],["University of Minnesota, Twin Cities","ミネソタ大学ツインシティ校","米国"],["University of North Carolina at Chapel Hill","ノースカロライナ大学 チャペルヒル校","米国"],["University of Notre Dame","ノートルダム大学","米国"],["University of Pennsylvania","ペンシルベニア大学","米国"],["University of Pittsburgh","ピッツバーグ大学","米国"],["University of Rochester","ロチェスター大学","米国"],["University of Southern California","南カリフォルニア大学","米国"],["University of Utah","ユタ大学","米国"],["University of Virginia","バージニア大学","米国"],["University of Washington","ワシントン大学（州立）","米国"],["University of Wisconsin - Madison","ウィスコンシン大学マディソン校","米国"],["Vanderbilt University","ヴァンダービルト大学","米国"],["Virginia Polytechnic Institute and State University","バージニア工科大学","米国"],["Washington University in St. Louis","セントルイス・ワシントン大学","米国"],["Yale University","イェール大学","米国"],["Hanyang University","漢陽大学校","韓国"],["Korea Advanced Institute of Science and Technology(KAIST)","韓国科学技術院（KAIST）","韓国"],["Korea University","高麗大学校","韓国"],["Pohang University of Science and Technology","浦項工科大学校","韓国"],["Seoul National University","ソウル大学校","韓国"],["Sungkyunkwan University (SKKU)","成均館大学校","韓国"],["Yonsei University (Seoul Campus)","延世大学校","韓国"],["City University of Hong Kong","香港城市大学","香港"],["Hong Kong Baptist University","香港浸会大学","香港"],["The Chinese University of Hong Kong","香港中文大学","香港"],["The Hong Kong Polytechnic University","香港理工大学","香港"],["The Hong Kong University of Science and Technology","香港科技大学","香港"],["The University of Hong Kong","香港大学","香港"]];

        function searchUniversity() {
            const query = document.getElementById('uni-search').value.trim().toLowerCase();
            const resultsEl = document.getElementById('uni-results');
            const msgEl = document.getElementById('uni-match-msg');

            if (query.length < 2) {
                resultsEl.classList.remove('show');
                msgEl.innerHTML = '';
                return;
            }

            const matches = uniData.filter(u =>
                u[0].toLowerCase().includes(query) ||
                u[1].toLowerCase().includes(query) ||
                u[1].includes(query)
            ).slice(0, 10);

            if (matches.length === 0) {
                resultsEl.classList.remove('show');
                if (currentLang === 'zh') {
                    msgEl.innerHTML = '<div class="uni-match-no">未找到匹配的大学。该大学可能不在加分名单中。</div>';
                } else {
                    msgEl.innerHTML = '<div class="uni-match-no">該当する大学が見つかりません。加点対象外の可能性があります。</div>';
                }
                return;
            }

            msgEl.innerHTML = '';
            resultsEl.innerHTML = matches.map(u =>
                `<div class="uni-result-item" onclick="selectUniversity('${u[0].replace(/'/g, "\\'")}', '${u[1].replace(/'/g, "\\'")}', '${u[2]}')">
                    <span>${u[0]}<br><small>${u[1]}</small></span>
                    <span class="uni-result-country">${u[2]}</span>
                </div>`
            ).join('');
            resultsEl.classList.add('show');
        }

        function selectUniversity(en, ja, country) {
            const searchEl = document.getElementById('uni-search');
            const resultsEl = document.getElementById('uni-results');
            const msgEl = document.getElementById('uni-match-msg');

            searchEl.value = en;
            resultsEl.classList.remove('show');

            if (currentLang === 'zh') {
                msgEl.innerHTML = `<div class="uni-match-yes">\u2713 ${ja}（${country}）是加分对象大学！</div>`;
            } else {
                msgEl.innerHTML = `<div class="uni-match-yes">\u2713 ${ja}（${country}）は加点対象大学です！</div>`;
            }

            document.getElementById('top-university').checked = true;
            calculate();
        }

        // Close results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.uni-search-wrap')) {
                document.getElementById('uni-results').classList.remove('show');
            }
        });

        // Initialize
        switchCategory('academic');
    </script>
</body>
</html>
